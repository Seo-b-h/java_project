<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <meta charset="UTF-8">
    <title>게시판</title>
    <style type="text/css">
        li {list-style: none; display:inline; padding: 6px;}
    </style>
</head>
<body>
<div id="root">
    <header>
        <h1>게시판</h1>
    </header>
    <hr/>
    <div>
        <ul>
            <li><a th:href="@{/board/list}">목록</a></li>
            <li><a th:href="@{/board/writeView}">글 작성</a></li>
            <th:block th:if="${session.member == null}">
                <li><a th:href="@{/}">로그인</a></li>
            </th:block>
            <th:block th:if="${session.member != null}">
                <li><a th:href="@{/}">회원 정보</a></li>
                <li><a th:href="@{/member/logout}">로그 아웃</a></li>
                <p th:text="${session.member.ID}+'님 안녕하세요.'"></p>
            </th:block>
        </ul>
    </div>
    <hr/>
    <section id="container">
        <table class="table table-hover">
            <tr>
                <th>번호</th>
                <th>제목</th>
                <th>작성자</th>
                <th>등록일</th>
            </tr>
            <tr th:each="item : ${list}">
                <td th:text="${item.BoardNumber}"></td>
                <td>
                    <!--          <a th:href="@{/board/readView(BoardNumber=${item.BoardNumber})}" th:text="${item.title}"></a>-->
                    <a th:href="@{/board/readView(BoardNumber=${item.BoardNumber}, page=${scri.page}, perPageNum=${scri.perPageNum}, searchType=${scri.searchType}, keyword=${scri.keyword})}">
                        <span th:text="${item.title}"></span>
                    </a>
                </td>
                <td th:text="${item.writer}"></td>
                <td th:text="${item.register}"></td>
            </tr>
        </table>
        <div class="search">
            <div class="col-xs-2 col-sm-2">
            <select name="searchType" class="form-control" th:field="${scri.searchType}">
                <option value="n" th:selected="${scri.searchType == null}">-----</option>
                <option value="t" th:selected="${scri.searchType == 't'}">제목</option>
                <option value="c" th:selected="${scri.searchType == 'c'}">내용</option>
                <option value="w" th:selected="${scri.searchType == 'w'}">작성자</option>
                <option value="tc" th:selected="${scri.searchType == 'tc'}">제목+내용</option>
            </select>
            </div>

            <div class="col-xs-10 col-sm-10">
                <div class="input-group">
                    <input type="text" name="keyword" id="keywordInput" th:value="${scri.keyword}" class="form-control"/>
                    <span class="input-group-btn">
                        <button id="searchBtn" type="button" class="btn btn-default">검색</button>
                    </span>
                </div>
            </div>

            <script th:inline="javascript">
                $(document).ready(function () {
                    $('#searchBtn').click(function () {
                        var searchType = $('select[name="searchType"]').val();
                        var keyword = $('#keywordInput').val();
                        var url = "?page=1&perPageNum=10";
                        window.location.href = url + "&searchType=" + searchType + "&keyword=" + encodeURIComponent(keyword);
                    });
                });
            </script>
        </div>

        <div class="col-md-offset-3">
            <ul class="pagination">
                <th:block th:if="${pageMaker.prev}">
                    <li><a th:href="'list' + ${pageMaker.makeSearch(pageMaker.startPage - 1)}">이전</a></li>
                </th:block>

                <th:block th:each="idx : ${#numbers.sequence(pageMaker.startPage, pageMaker.endPage)}">
                    <li th:class="${pageMaker.cri.page == idx} ? 'info' : ''">
                        <a th:href="@{list/__${pageMaker.makeSearch(idx)}__}" th:text="${idx}"></a>
                    </li>
                </th:block>

                <th:block th:if="${pageMaker.next &amp;&amp; pageMaker.endPage &gt; 0}">
                    <li><a th:href="'list' + ${pageMaker.makeSearch(pageMaker.endPage + 1)}">다음</a></li>
                </th:block>
            </ul>
        </div>
    </section>
    <hr/>
</div>
</body>
</html>
